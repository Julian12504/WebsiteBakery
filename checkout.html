<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thanh ToÃ¡n ÄÆ¡n HÃ ng</title>
    <link rel="stylesheet" href="./assets/client_style.css"> 
    <link rel="stylesheet" href="./assets/client_checkout_user.css"> 
</head>
<body>
    
    <script>
        // YÃªu cáº§u client_auth.js pháº£i cÃ³ hÃ m getCurrentUser()
        if (!localStorage.getItem('client_user_data')) {
            alert('Báº¡n cáº§n Ä‘Äƒng nháº­p Ä‘á»ƒ tiáº¿n hÃ nh thanh toÃ¡n.');
            window.location.href = 'login.html'; // Chuyá»ƒn hÆ°á»›ng vá» trang Ä‘Äƒng nháº­p
        }
    </script>

    <header class="main-header">
        <div class="logo"><a href="index2.html"><h1>ğŸ° TIá»†M BÃNH CAO Cáº¤P</h1></a></div>
        <nav class="main-nav">
            <a href="index2.html">Trang Chá»§</a>
            <a href="product_list2.html">Sáº£n Pháº©m</a>
            <a href="cart.html" class="cart-icon active">ğŸ›’ Giá» HÃ ng (<span id="cart-count">0</span>)</a> 
            
            <span id="client-welcome-msg" style="display: none; margin-right: 5px; color: #333;"></span> 
            <a href="login.html" id="client-auth-link">ÄÄƒng Nháº­p</a> 
        </nav>
    </header>

    <main class="checkout-page-content">
        <p><a href="cart.html">â† Quay láº¡i Giá» hÃ ng</a></p>
        <h2>ğŸ§¾ XÃC NHáº¬N VÃ€ THANH TOÃN</h2>
        
        <form class="checkout-form" id="checkout-form">
            <div class="shipping-info">
                <h3>1. ThÃ´ng Tin Giao HÃ ng</h3>
                <label>
                    <input type="radio" name="address_option" value="account" id="use-account-address" checked> Sá»­ dá»¥ng Ä‘á»‹a chá»‰ tÃ i khoáº£n (123 ÄÆ°á»ng BÃ¡nh Kem...)
                </label>
                <label>
                    <input type="radio" name="address_option" value="new" id="use-new-address"> Giao Ä‘áº¿n Ä‘á»‹a chá»‰ má»›i
                </label>

                <div id="new-address-fields" style="margin-top: 15px; display: none;">
                    <label for="fullname">Há» vÃ  TÃªn ngÆ°á»i nháº­n:</label>
                    <input type="text" id="fullname">
                    
                    <label for="phone">Sá»‘ Ä‘iá»‡n thoáº¡i:</label>
                    <input type="tel" id="phone">

                    <label for="address_detail">Äá»‹a chá»‰ chi tiáº¿t:</label>
                    <textarea id="address_detail" rows="3"></textarea>
                </div>
                
                <label for="note">Ghi chÃº (YÃªu cáº§u viáº¿t chá»¯ lÃªn bÃ¡nh):</label>
                <textarea id="note" rows="2"></textarea>
            </div>

            <div class="order-summary-box">
                <div class="payment-method">
                    <h3>2. HÃ¬nh Thá»©c Thanh ToÃ¡n</h3>
                    <label><input type="radio" name="payment" value="cod" checked> Thanh toÃ¡n khi nháº­n hÃ ng (COD)</label>
                    <label><input type="radio" name="payment" value="bank"> Chuyá»ƒn khoáº£n ngÃ¢n hÃ ng</label>
                </div>

                <div class="order-summary">
                    <h3>3. TÃ³m Táº¯t ÄÆ¡n HÃ ng</h3>
                    <div id="checkout-summary-details">
                        <p>Táº¡m tÃ­nh (<span id="summary-item-count">0</span> SP): <span id="summary-subtotal">0 VNÄ</span></p>
                        <p>PhÃ­ váº­n chuyá»ƒn: <span id="summary-shipping">30.000 VNÄ</span></p>
                        <hr>
                        <p class="total-final">Tá»•ng Thanh ToÃ¡n: **<span id="summary-total">0 VNÄ</span>**</p>
                    </div>
                    
                    <button type="submit" class="btn-primary btn-place-order">HOÃ€N Táº¤T Äáº¶T HÃ€NG</button>
                    <p style="font-size: 0.8em; text-align: center; margin-top: 10px;">Báº±ng cÃ¡ch Ä‘áº·t hÃ ng, báº¡n Ä‘á»“ng Ã½ vá»›i cÃ¡c Ä‘iá»u khoáº£n cá»§a chÃºng tÃ´i.</p>
                </div>
            </div>
        </form>
    </main>

    <footer>
        <p>&copy; 2025 Tiá»‡m BÃ¡nh Cao Cáº¥p. Sá»‘ Ä‘iá»‡n thoáº¡i liÃªn há»‡: 0938176419.</p>
    </footer>
    
    <script src="./assets/client_auth.js"></script> 
    <script src="./assets/cart_script.js"></script>
    <script src="./assets/client_script.js"></script> 

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const newAddressRadio = document.getElementById('use-new-address');
            const newAddressFields = document.getElementById('new-address-fields');
            const accountAddressRadio = document.getElementById('use-account-address');

            // HÃ m xá»­ lÃ½ viá»‡c hiá»ƒn thá»‹/áº©n trÆ°á»ng Ä‘á»‹a chá»‰ má»›i
            const toggleAddressFields = () => {
                if (newAddressRadio.checked) {
                    newAddressFields.style.display = 'block';
                    // Báº­t thuá»™c tÃ­nh required khi hiá»ƒn thá»‹
                    newAddressFields.querySelectorAll('input, textarea').forEach(el => el.required = true);
                } else {
                    newAddressFields.style.display = 'none';
                    // Táº¯t thuá»™c tÃ­nh required khi áº©n
                    newAddressFields.querySelectorAll('input, textarea').forEach(el => el.required = false);
                }
            };

            newAddressRadio.addEventListener('change', toggleAddressFields);
            accountAddressRadio.addEventListener('change', toggleAddressFields);
            
            // Khá»Ÿi táº¡o tráº¡ng thÃ¡i form (máº·c Ä‘á»‹nh lÃ  áº©n)
            toggleAddressFields();

            // âš ï¸ QUAN TRá»ŒNG: Cáº§n cÃ³ code JS Ä‘á»ƒ Ä‘iá»n/tÃ­nh toÃ¡n giÃ¡ trá»‹ thá»±c
            // (Hiá»‡n táº¡i Ä‘ang lÃ  giÃ¡ trá»‹ tÄ©nh, cáº§n tÃ­ch há»£p logic tá»« cart_script.js)
            // VÃ­ dá»¥: window.renderCheckoutSummary();
        });
    </script>
</body>
</html>